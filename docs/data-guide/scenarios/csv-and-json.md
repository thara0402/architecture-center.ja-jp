---
title: CSV ファイルと JSON ファイルの処理
description: ''
author: zoinerTejada
ms.date: 02/12/2018
ms.openlocfilehash: 78d57ac4f229e863e676bf3cad0140864cd243d1
ms.sourcegitcommit: 1f4cdb08fe73b1956e164ad692f792f9f635b409
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/08/2019
ms.locfileid: "54113984"
---
# <a name="working-with-csv-and-json-files-for-data-solutions"></a><span data-ttu-id="74cda-102">データ ソリューションでの CSV ファイルと JSON ファイルの操作</span><span class="sxs-lookup"><span data-stu-id="74cda-102">Working with CSV and JSON files for data solutions</span></span>

<span data-ttu-id="74cda-103">CSV と JSON は、非構造化または半構造化データの取り込み、交換、および格納を行うために使用される可能性が高い最も一般的な形式です。</span><span class="sxs-lookup"><span data-stu-id="74cda-103">CSV and JSON are likely the most common formats used for ingesting, exchanging, and storing unstructured or semi-structured data.</span></span>

## <a name="about-csv-format"></a><span data-ttu-id="74cda-104">CSV 形式について</span><span class="sxs-lookup"><span data-stu-id="74cda-104">About CSV format</span></span>

<span data-ttu-id="74cda-105">CSV (コンマ区切り値) ファイルは、システム間で表形式のデータをプレーン テキストで交換するときに一般的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-105">CSV (comma-separated values) files are commonly used to exchange tabular data between systems in plain text.</span></span> <span data-ttu-id="74cda-106">通常は、データの列名を提供するヘッダー行を含みますが、それ以外は半構造化であるとみなされます。</span><span class="sxs-lookup"><span data-stu-id="74cda-106">They typically contain a header row that provides column names for the data, but are otherwise considered semi-structured.</span></span> <span data-ttu-id="74cda-107">それは、CSV では必然的に階層データまたはリレーショナル データを表すことができないという事実があるためです。</span><span class="sxs-lookup"><span data-stu-id="74cda-107">This is due to the fact that CSVs cannot naturally represent hierarchical or relational data.</span></span> <span data-ttu-id="74cda-108">データのリレーションシップは、通常、複数の CSV ファイルによって処理され、外部キーが 1 つ以上のファイルの列に格納されますが、これらのファイル間のリレーションシップが形式自体で表されることはありません。</span><span class="sxs-lookup"><span data-stu-id="74cda-108">Data relationships are typically handled with multiple CSV files, where foreign keys are stored in columns of one or more files, but the relationships between those files are not expressed by the format itself.</span></span> <span data-ttu-id="74cda-109">CSV 形式のファイルには、コンマだけでなく、タブやスペースなどの他の区切り記号も使用できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-109">Files in CSV format may use other delimiters besides commas, such as tabs or spaces.</span></span>

<span data-ttu-id="74cda-110">制約があるにもかかわらず、CSV ファイルはデータ交換用の一般的な選択肢です。その理由は、幅広いビジネス、コンシューマー、および科学アプリケーションによってサポートされているためです。</span><span class="sxs-lookup"><span data-stu-id="74cda-110">Despite their limitations, CSV files are a popular choice for data exchange, because they are supported by a wide range of business, consumer, and scientific applications.</span></span> <span data-ttu-id="74cda-111">たとえば、データベースやスプレッドシート プログラムは、CSV ファイルのインポートとエクスポートを実行できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-111">For example, database and spreadsheet programs can import and export CSV files.</span></span> <span data-ttu-id="74cda-112">同様に、ほとんどのバッチおよびストリーム データ処理エンジン (Spark や Hadoop など) では、CSV 形式のファイルのシリアル化と逆シリアル化をネイティブにサポートし、読み取り時にスキーマを適用する方法を用意しています。</span><span class="sxs-lookup"><span data-stu-id="74cda-112">Similarly, most batch and stream data processing engines, such as Spark and Hadoop, natively support serializing and deserializing CSV-formatted files and offer ways to apply a schema on read.</span></span> <span data-ttu-id="74cda-113">これにより、クエリを実行して高速処理に適した効率の良いデータ形式で情報を格納するオプションを提供することで、データを操作しやすくします。</span><span class="sxs-lookup"><span data-stu-id="74cda-113">This makes it easier to work with the data, by offering options to query against it and store the information in a more efficient data format for faster processing.</span></span>

## <a name="about-json-format"></a><span data-ttu-id="74cda-114">JSON 形式について</span><span class="sxs-lookup"><span data-stu-id="74cda-114">About JSON format</span></span>

<span data-ttu-id="74cda-115">JSON (JavaScript Object Notation) データは、半構造化された形式でキーと値のペアとして表されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-115">JSON (JavaScript Object Notation) data is represented as key-value pairs in a semi-structured format.</span></span> <span data-ttu-id="74cda-116">JSON はしばしば XML と比較されますが、それは両方とも、データを階層形式で格納できるためであり、子データはその親を使用してインラインで表わされます。</span><span class="sxs-lookup"><span data-stu-id="74cda-116">JSON is often compared to XML, as both are capable of storing data in hierarchical format, with child data represented inline with its parent.</span></span> <span data-ttu-id="74cda-117">どちらも自己記述的で人間が判読可能ですが、JSON ドキュメントのほうがはるかに小さくなる傾向があり、オンラインでのデータ交換、特に REST ベースの Web サービスで一般的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-117">Both are self-describing and human readable, but JSON documents tend to be much smaller, leading to their popular use in online data exchange, especially with the advent of REST-based web services.</span></span>

<span data-ttu-id="74cda-118">JSON 形式のファイルには、CSV を上回るいくつかの利点があります。</span><span class="sxs-lookup"><span data-stu-id="74cda-118">JSON-formatted files have several benefits over CSV:</span></span>

- <span data-ttu-id="74cda-119">JSON は階層構造を保持します。これにより、1 つのドキュメントに関連するデータを容易に保持でき、複雑なリレーションシップを表すことができます。</span><span class="sxs-lookup"><span data-stu-id="74cda-119">JSON maintains hierarchical structures, making it easier to hold related data in a single document and represent complex relationships.</span></span>
- <span data-ttu-id="74cda-120">ほとんどのプログラミング言語は、JSON のオブジェクトへの逆シリアル化をネイティブにサポートするか、軽量の JSON シリアル化ライブラリを提供しています。</span><span class="sxs-lookup"><span data-stu-id="74cda-120">Most programming languages provide native support for deserializing JSON into objects, or provide lightweight JSON serialization libraries.</span></span>
- <span data-ttu-id="74cda-121">JSON では、オブジェクトのリストをサポートします。これにより、リストをリレーショナル データ モデルに変換するという面倒な作業を回避できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-121">JSON supports lists of objects, helping to avoid messy translations of lists into a relational data model.</span></span>
- <span data-ttu-id="74cda-122">JSON は、MongoDB、Couchbase、Azure Cosmos DB などの NoSQL データベースで一般的に使用されるファイル形式です。</span><span class="sxs-lookup"><span data-stu-id="74cda-122">JSON is a commonly used file format for NoSQL databases, such as MongoDB, Couchbase, and Azure Cosmos DB.</span></span>

<span data-ttu-id="74cda-123">ネットワーク経由で受信する大量のデータは既に JSON 形式になっているため、ほとんどの Web ベースのプログラミング言語は JSON の操作をネイティブにサポートしているか、外部ライブラリを使用して JSON データのシリアル化と逆シリアル化を実行します。</span><span class="sxs-lookup"><span data-stu-id="74cda-123">Since a lot of data coming across the wire is already in JSON format, most web-based programming languages support working with JSON natively, or through the use of external libraries to serialize and deserialize JSON data.</span></span> <span data-ttu-id="74cda-124">この JSON のユニバーサル サポートが、データ構造の表現による論理形式での使用、ホット データ用の交換形式、およびコールド データ用のデータ記憶域につながっています。</span><span class="sxs-lookup"><span data-stu-id="74cda-124">This universal support for JSON has led to its use in logical formats through data structure representation, exchange formats for hot data, and data storage for cold data.</span></span>

<span data-ttu-id="74cda-125">多くのバッチおよびストリーム データ処理エンジンは、JSON のシリアル化と逆シリアル化をネイティブにサポートします。</span><span class="sxs-lookup"><span data-stu-id="74cda-125">Many batch and stream data processing engines natively support JSON serialization and deserialization.</span></span> <span data-ttu-id="74cda-126">JSON ドキュメントに含まれるデータは、最終的にはパフォーマンスが最適化された形式 (Parquet や Avro) で保存できますが、情報ソースの生データとして機能します。これはデータを必要に応じて再処理するために重要です。</span><span class="sxs-lookup"><span data-stu-id="74cda-126">Though the data contained within JSON documents may ultimately be stored in a more performance-optimized formats, such as Parquet or Avro, it serves as the raw data for source of truth, which is critical for reprocessing the data as needed.</span></span>

## <a name="when-to-use-csv-or-json-formats"></a><span data-ttu-id="74cda-127">いつ CSV 形式と JSON 形式を使用するか</span><span class="sxs-lookup"><span data-stu-id="74cda-127">When to use CSV or JSON formats</span></span>

<span data-ttu-id="74cda-128">CSV は、データのエクスポートとインポート、または分析と機械学習向けの処理で一般的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-128">CSVs are more commonly used for exporting and importing data, or processing it for analytics and machine learning.</span></span> <span data-ttu-id="74cda-129">JSON 形式のファイルにも同じ利点がありますが、ホット データ交換ソリューションで一般的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-129">JSON-formatted files have the same benefits, but are more common in hot data exchange solutions.</span></span> <span data-ttu-id="74cda-130">JSON ドキュメントは、多くの場合、オンライン トランザクションを実行する Web サービスとモバイル サービス、片方向または双方向通信を行う IoT (モノのインターネット) デバイス、または SaaS サービス、PaaS サービス、またはサーバーレス サービス アーキテクチャと通信するクライアントアプリケーションによって送信されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-130">JSON documents are often sent by web and mobile devices performing online transactions, by IoT (internet of things) devices for one-way or bidirectional communication, or by client applications communicating with SaaS and PaaS services or serverless architectures.</span></span>

<span data-ttu-id="74cda-131">CSV ファイル形式と JSON ファイル形式は、どちらも、異種システムまたはデバイスの間でデータを簡単に交換できるようにします。</span><span class="sxs-lookup"><span data-stu-id="74cda-131">CSV and JSON file formats both make it easy to exchange data between dissimilar systems or devices.</span></span> <span data-ttu-id="74cda-132">半構造化された形式によってほぼすべての種類のデータを柔軟に転送することができ、これらの形式のユニバーサル サポートによって簡単に使用できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-132">Their semi-structured formats allow flexibility in transferring almost any type of data, and universal support for these formats make them simple to work with.</span></span> <span data-ttu-id="74cda-133">両方とも、効率的なクエリを実行するために処理後のデータがバイナリ形式で格納されている場合でも、情報の生のソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-133">Both can be used as the raw source of truth in cases where the processed data is stored in binary formats for more efficient querying.</span></span>

## <a name="working-with-csv-and-json-data-in-azure"></a><span data-ttu-id="74cda-134">Azure での CSV データと JSON データの操作</span><span class="sxs-lookup"><span data-stu-id="74cda-134">Working with CSV and JSON data in Azure</span></span>

<span data-ttu-id="74cda-135">Azure では、ニーズに応じて、CSV ファイルと JSON ファイルを操作するためのさまざまなソリューションを用意しています。</span><span class="sxs-lookup"><span data-stu-id="74cda-135">Azure provides several solutions for working with CSV and JSON files, depending on your needs.</span></span> <span data-ttu-id="74cda-136">これらのファイルの主な配置場所は、Azure Storage または Azure Data Lake Store です。</span><span class="sxs-lookup"><span data-stu-id="74cda-136">The primary landing place for these files is either Azure Storage or Azure Data Lake Store.</span></span> <span data-ttu-id="74cda-137">これらのファイルと他のテキスト ベースのファイルを操作する Azure サービスの大半は、いずれかのオブジェクト ストレージ サービスと統合します。</span><span class="sxs-lookup"><span data-stu-id="74cda-137">Most Azure services that work with these and other text-based files integrate with either object storage service.</span></span> <span data-ttu-id="74cda-138">ただし、状況によっては、Azure SQL またはその他のデータ ストアに直接データをインポートすることを選択できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-138">In some situations, however, you may opt to directly import the data into Azure SQL or some other data store.</span></span> <span data-ttu-id="74cda-139">SQL Server は、JSON ドキュメントの格納と操作をネイティブにサポートします。これにより、[これらの種類のファイルのインポートと処理](/sql/relational-databases/json/import-json-documents-into-sql-server)を簡単に実行できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-139">SQL Server has native support for storing and working with JSON documents, which makes it easy to [import and process those types of files](/sql/relational-databases/json/import-json-documents-into-sql-server).</span></span> <span data-ttu-id="74cda-140">SQL Bulk Import などのユーティリティを使用して、[CSV ファイルのインポート](/sql/relational-databases/json/import-json-documents-into-sql-server)を簡単に実行できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-140">You can use a utility like SQL Bulk Import to easily [import CSV files](/sql/relational-databases/json/import-json-documents-into-sql-server).</span></span>

<span data-ttu-id="74cda-141">Azure SQL にインポートせずに、Azure Blob Storage から直接 JSON ファイルにクエリを実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="74cda-141">You can also query JSON files directly from Azure Blob Storage without importing them into Azure SQL.</span></span> <span data-ttu-id="74cda-142">このアプローチの完全な例については、「[Work with JSON files with Azure SQL (Azure SQL を使用して JSON ファイルを操作する)](https://medium.com/@mauridb/work-with-json-files-with-azure-sql-8946f066ddd4)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="74cda-142">For a complete example of this approach, see [Work with JSON files with Azure SQL](https://medium.com/@mauridb/work-with-json-files-with-azure-sql-8946f066ddd4).</span></span> <span data-ttu-id="74cda-143">現時点では、このオプションは、CSV ファイルには使用できません。</span><span class="sxs-lookup"><span data-stu-id="74cda-143">Currently this option isn't available for CSV files.</span></span>

<span data-ttu-id="74cda-144">シナリオに応じて、データの[バッチ処理](../big-data/batch-processing.md)または[リアルタイム処理](../big-data/real-time-processing.md)を実行できます。</span><span class="sxs-lookup"><span data-stu-id="74cda-144">Depending on the scenario, you may perform [batch processing](../big-data/batch-processing.md) or [real-time processing](../big-data/real-time-processing.md) of the data.</span></span>

## <a name="challenges"></a><span data-ttu-id="74cda-145">課題</span><span class="sxs-lookup"><span data-stu-id="74cda-145">Challenges</span></span>

<span data-ttu-id="74cda-146">これらの形式を使用する際に検討するいくつかの課題があります。</span><span class="sxs-lookup"><span data-stu-id="74cda-146">There are some challenges to consider when working with these formats:</span></span>

- <span data-ttu-id="74cda-147">データ モデルに制限がないため、CSV ファイルと JSON ファイルは、データの破損が発生する傾向があります ("ゴミを入れるとゴミが出てくる")。</span><span class="sxs-lookup"><span data-stu-id="74cda-147">Without any restraints on the data model, CSV and JSON files are prone to data corruption ("garbage in, garbage out").</span></span> <span data-ttu-id="74cda-148">たとえば、どちらのファイルにも date/time オブジェクトの概念がありません。このため、たとえば "ABC123" の日付フィールドへの挿入がファイル形式によって禁止されることはありません。</span><span class="sxs-lookup"><span data-stu-id="74cda-148">For instance, there's no notion of a date/time object in either file, so the file format does not prevent you from inserting "ABC123" in a date field, for example.</span></span>

- <span data-ttu-id="74cda-149">コールド記憶域ソリューションとして CSV ファイルと JSON ファイルを使用した場合、ビッグ データの操作で適切な拡張は行われません。</span><span class="sxs-lookup"><span data-stu-id="74cda-149">Using CSV and JSON files as your cold storage solution does not scale well when working with big data.</span></span> <span data-ttu-id="74cda-150">ほとんどの場合、並列処理用にパーティションに分割することはできません。バイナリ形式のように圧縮することもできません。</span><span class="sxs-lookup"><span data-stu-id="74cda-150">In most cases, they cannot be split into partitions for parallel processing, and cannot be compressed as well as binary formats.</span></span> <span data-ttu-id="74cda-151">多くの場合、データの処理と格納が Parquet や ORC (Optimized Row Columnar) などの 読み取り用に最適化された形式で行われることになります。また、格納されているデータに関するインデックスとインライン統計も提供されます。</span><span class="sxs-lookup"><span data-stu-id="74cda-151">This often leads to processing and storing this data into read-optimized formats such as Parquet and ORC (optimized row columnar), which also provide indexes and inline statistics about the data contained.</span></span>

- <span data-ttu-id="74cda-152">クエリと分析を容易にできるように、半構造化データに関するスキーマの適用が必要になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="74cda-152">You may need to apply a schema on the semi-structured data to make it easier to query and analyze.</span></span> <span data-ttu-id="74cda-153">通常、環境のデータ記憶域のニーズに適合する別の形式でデータを格納する必要があります (データベース内など)。</span><span class="sxs-lookup"><span data-stu-id="74cda-153">Typically, this requires storing the data in another form that complies with your environment's data storage needs, such as within a database.</span></span>
